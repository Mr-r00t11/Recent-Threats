# Arbitrary JavaScript execution in PDF.js - CVE-2024-4367
___
Faltaba una verificación de tipo al manejar fuentes en PDF.js, lo que permitiría la ejecución arbitraria de JavaScript en el contexto de PDF.js. Esta vulnerabilidad afecta a Firefox < 126, Firefox ESR < 115.11 y Thunderbird < 115.11.

Si se utiliza pdf.js para cargar un PDF malicioso y PDF.js está configurado con *isEvalSupported* establecido en verdadero (que es el valor predeterminado), se ejecutará JavaScript sin restricciones controlado por el atacante en el contexto del dominio de alojamiento.
___
Descargamos el exploit desde el siguiente enlace:
- https://github.com/s4vvysec/CVE-2024-4367-POC
- https://github.com/LOURC0D3/CVE-2024-4367-PoC

Ejecutamos el exploit, donde le pasaremos como parámetro el nombre del PDF que queremos guardar y le indicamos el *payload* en formato *JS*.

Con la función *alert*, estamos generando una ventana emergente en el navegador.
```bash
┌──(mr-r00t㉿mr-r00t)-[~/Exploits/CVE-2024-4367-POC]
└─$ python3 poc.py malicious.pdf "alert\('Has been you hacked!')"
[*] POC Generated
```

Una vez ya generado el documento malicioso, ejecutamos el *PDF* y nos ejecutara en una ventana el script que hemos inyectado.
![[Screenshot_2024-05-23_19_45_13.png]]
___
